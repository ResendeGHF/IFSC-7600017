      PROGRAM MAIN
      CHARACTER FNAME*30
      
      NF = 3
      G = 9.8
      EXT = 2.0/3.0
      DT = 0.04
      TMAX = 20.0
      AGAMMA = 0.05
      ALENGHT = 9.8
      OMEGA_0 = 0.0
      PI = ACOS(-1.0)
      THETA_0 = PI/32
      THETA = THETA_0  

      REAL F_0(INT(NF*2)), OUTS(INT(TMAX/DT),INT((NF*2)+1))
      DATA F_0 \ 0.0, 0.5, 1.2 \
      DATA (OUTS(I,1), I=1, INT(TMAX/DT)) \ DT*I \

      DO J=2, INT((NF*2)+1), 2
         I = 1
100      CONTINUE
         OMEGA = OMEGA - (G/ALENGHT)*(THETA*DT) - (AGAMMA*OMEGA*DT) + 
     + (F_0(J)*SIN(EXT*T))*DT
         THETA = THETA + OMEGA * DT
         T = I * DT
         I = I + 1
         THETA = MOD(THETA,2*PI)
         IF ( T .GE. TMAX ) GOTO 200
         OUTS(I,J) = THETA
         OUTS(I,J+1) = OMEGA
         GOTO 100
200      CONTINUE
      END DO

      FNAME = 'saida-tarefa-2b4-15457752.out'
      OPEN(UNIT=10,FILE=FNAME,STATUS='REPLACE')
45    FORMAT(F15.10,',',F15.10,',',F15.10)
      WRITE(10,45) OUTS
      CLOSE(10)

      END
